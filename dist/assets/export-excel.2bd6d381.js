var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{p as s,g as i}from"./index.6420dcfd.js";import{u as c,a as d}from"./table.9eaf7aec.js";import{X as p}from"./xlsx.24719336.js";import{d as u,k as f,l as b,e as m,r as y,o as x,c as g,a as k,w as j,D as v}from"./vendor.25688f0d.js";var h=u({name:"ExportExcel",setup(){const e=f(null),u=c(),y=d([u.indexColumn,{title:"名称",key:"nickName"},{title:"性别",key:"gender",width:80,render:e=>b("div",0===e.gender?"男":"女")},{title:"地址",key:"address"},{title:"上次登录时间",key:"lastLoginTime"},{title:"上次登录IP",key:"lastLoginIp"}],{align:"center"});return m((function(){s({url:i,data:{page:1,pageSize:20}}).then(u.handleSuccess).catch(console.log)})),x=((e,t)=>{for(var a in t||(t={}))r.call(t,a)&&n(e,a,t[a]);if(l)for(var a of l(t))o.call(t,a)&&n(e,a,t[a]);return e})({tableRef:e,tableColumns:y},u),t(x,a({exportExcel:function(){const t=p.utils.table_to_sheet(e.value.$el),a=p.utils.book_new();p.utils.book_append_sheet(a,t,"数据报表"),p.writeFile(a,"tale-list.xlsx")}}));var x}});const w={class:"main-container"},O=v("导出Excel ");h.render=function(e,t,a,l,r,o){const n=y("n-button"),s=y("TableHeader"),i=y("n-data-table"),c=y("TableBody");return x(),g("div",w,[k(s,{"show-filter":!1},{"top-right":j((()=>[k(n,{type:"primary",size:"small",onClick:e.exportExcel},{default:j((()=>[O])),_:1},8,["onClick"])])),_:1}),k(c,{ref:"tableBody"},{default:j((()=>[k(i,{ref:"tableRef",data:e.dataList,columns:e.tableColumns},null,8,["data","columns"])])),_:1},512)])};export default h;
