var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n;import{p as s,g as i}from"./index.31991717.js";import{u as c,b as d,a as p}from"./table.59ac310f.js";import{X as u}from"./xlsx.256ecd7b.js";import{d as m,m as f,A as b,n as y,g,r as h,o as w,c as k,a as x,w as j,D as v}from"./vendor.02de9c8e.js";var O=m({name:"ExportRowsExcel",setup(){const e=f(null),m=c(),h=b(),w=[],k=d("id"),x=p([m.selectionColumn,m.indexColumn,{title:"名称",key:"nickName"},{title:"性别",key:"gender",width:80,render:e=>y("div",0===e.gender?"男":"女")},{title:"地址",key:"address"},{title:"上次登录时间",key:"lastLoginTime"},{title:"上次登录IP",key:"lastLoginIp"}],{align:"center"});return g((function(){s({url:i,data:{page:1,pageSize:20}}).then(m.handleSuccess).catch(console.log)})),j=((e,t)=>{for(var a in t||(t={}))o.call(t,a)&&l(e,a,t[a]);if(n)for(var a of n(t))r.call(t,a)&&l(e,a,t[a]);return e})({tableRef:e},m),t(j,a({tableColumns:x,rowKey:k,exportExcel:function(){if(0===w.length)return void h.error("请选择要导出的行");const e=w.map((e=>m.dataList.find((t=>t.id===e)))).map((e=>[e.nickName,0===e.gender?"男":"女",e.address,e.lastLoginTime,e.lastLoginIp]));e.unshift(["昵称","性别","地址","上次登录时间","上次登录IP"]);const t=u.utils.aoa_to_sheet(e),a=u.utils.book_new();u.utils.book_append_sheet(a,t,"数据报表"),u.writeFile(a,"table-list.xlsx")},handleSelectionChange:function(e){w.length=0,w.push(...e)}}));var j}});const C={class:"main-container"},_=v("导出选中的Excel ");O.render=function(e,t,a,n,o,r){const l=h("n-button"),s=h("TableHeader"),i=h("n-data-table"),c=h("TableBody");return w(),k("div",C,[x(s,{"show-filter":!1},{"top-right":j((()=>[x(l,{type:"primary",size:"small",onClick:e.exportExcel},{default:j((()=>[_])),_:1},8,["onClick"])])),_:1}),x(c,null,{default:j((()=>[x(i,{ref:"tableRef",data:e.dataList,columns:e.tableColumns,"row-key":e.rowKey,"onUpdate:checkedRowKeys":e.handleSelectionChange},null,8,["data","columns","row-key","onUpdate:checkedRowKeys"])])),_:1})])};export default O;
