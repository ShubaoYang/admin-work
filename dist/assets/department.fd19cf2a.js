var I=Object.defineProperty,L=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var k=(e,u,a)=>u in e?I(e,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[u]=a,y=(e,u)=>{for(var a in u||(u={}))M.call(u,a)&&k(e,a,u[a]);if(C)for(var a of C(u))N.call(u,a)&&k(e,a,u[a]);return e},B=(e,u)=>L(e,x(u));import{p as O,o as P,q as U,m as V,n as S,r as q}from"./index.d023bfa5.js";import{a as K,c as z,e as G}from"./table.18292b07.js";import{_ as A}from"./lodash.bfcb0b1d.js";import{g as H}from"./form.8ba9c808.js";import{d as J,a6 as Q,M as W,g as r,aE as T,k as X,s as Y,h as _,ad as Z,al as $,r as ee,o as ue,q as ne,a as i,w as p,bd as te}from"./vendor.88197545.js";function ae(){return O}const w="dp_code_",g=[{key:"parentId",label:"\u7236\u7EA7\u90E8\u95E8",value:r(null),optionItems:Y([]),render:e=>_(Z,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u90E8\u95E8",options:e.optionItems})},{key:"name",label:"\u90E8\u95E8\u540D\u79F0",type:"input",value:r(null),render:e=>_($,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},maxlength:50,placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"}),validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"),!1)},{label:"\u90E8\u95E8\u7F16\u53F7",key:"depCode",value:r(null),render:e=>_($,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u7F16\u53F7"},{prefix:()=>w}),validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u90E8\u95E8\u7F16\u53F7"),!1)}];var oe=J({name:"Department",setup(){const e=K(),u=Q(),a=W(),D=z([{title:"\u90E8\u95E8\u540D\u79F0",key:"name"},{title:"\u90E8\u95E8\u7F16\u53F7",key:"depCode"},{title:"\u6392\u5E8F",key:"order"},{title:"\u72B6\u6001",key:"status",render:n=>H(n.status?"\u6B63\u5E38":"\u7981\u7528",{type:n.status?"success":"error",size:"small"})},{title:"\u64CD\u4F5C",key:"actions",render:n=>G([{label:"\u7F16\u8F91",onClick:b.bind(null,n)},{label:"\u5220\u9664",type:"error",onClick(){m(n)}}])}],{align:"center"}),d=r(null),h=r(null),s=r(null),F=ae();function f(){F({url:P}).then(e.handleSuccess).then(n=>{var o;const t=g.find(l=>l.key==="parentId");t.optionItems.length=0,(o=t==null?void 0:t.optionItems)==null||o.push(...n.map(l=>({label:l.name,value:l.id})))})}function c(n,t){for(let o=0;o<n.length;o++){const l=n[o];if(l.id===t.id){if(!A.isEmpty(l.children)){u.error("\u5F53\u524D\u90E8\u95E8\u4E0B\u6709\u5B50\u90E8\u95E8\uFF0C\u4E0D\u80FD\u5220\u9664");return}n.splice(o,1);return}else A.isEmpty(l.children)||c(l.children,t)}}const m=n=>{a.warning({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u4FE1\u606F\uFF0C\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF1F",positiveText:"\u5220\u9664",negativeText:"\u518D\u60F3\u60F3",onPositiveClick:()=>{c(e.dataList,n)}})};function E(){var n;(n=s.value)==null||n.toggle(),T(()=>{var t;(t=d.value)==null||t.reset()})}function R(){var n,t;((n=d.value)==null?void 0:n.validator())&&((t=s.value)==null||t.toggle(),a.success({title:"\u63D0\u793A",positiveText:"\u786E\u5B9A",content:"\u6A21\u62DF\u90E8\u95E8\u6DFB\u52A0/\u7F16\u8F91\u6210\u529F\uFF0C\u6570\u636E\u4E3A\uFF1A"+JSON.stringify(d.value.generatorParams())}))}function b(n){var t;(t=s.value)==null||t.toggle(),T(()=>{g.forEach(o=>{const l=o.key,v=n[l];v&&(o.key==="depCode"?o.value.value=v.replace(w,""):o.value.value=v)})})}function j(n){return n.id}return X(f),B(y({itemDataFormRef:d,searchDataFormRef:h,onDataFormConfirm:R,tableColumns:D,onUpdateItem:b},e),{onDeleteItem:m,onAddItem:E,itemFormOptions:g,rowKey:j,modalDialog:s})}});const le={class:"main-container"};function se(e,u,a,D,d,h){const s=U,F=V,f=te,c=S,m=ee("DataForm"),E=q;return ue(),ne("div",le,[i(c,null,{header:p(()=>[i(F,{"show-filter":!1},{"top-right":p(()=>[i(s,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1})]),default:p(()=>[i(f,{loading:e.tableLoading,data:e.dataList,columns:e.tableColumns,"row-key":e.rowKey},null,8,["loading","data","columns","row-key"])]),_:1}),i(E,{ref:"modalDialog",onConfirm:e.onDataFormConfirm},{content:p(()=>[i(m,{ref:"itemDataFormRef",options:e.itemFormOptions},null,8,["options"])]),_:1},8,["onConfirm"])])}oe.render=se;export{oe as default};
