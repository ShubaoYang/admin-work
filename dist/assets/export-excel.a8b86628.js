var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;import{p as s,g as i}from"./index.bd3d330c.js";import{u as c,a as d}from"./table.38630b50.js";import{X as p}from"./xlsx.b54e86f8.js";import{d as u,m as b,n as f,g as m,r as y,o as g,c as x,a as j,w as k,I as v}from"./vendor.204f34a9.js";var h=u({name:"ExportExcel",setup(){const e=b(null),u=c(),y=d([u.indexColumn,{title:"名称",key:"nickName"},{title:"性别",key:"gender",width:80,render:e=>f("div",0===e.gender?"男":"女")},{title:"地址",key:"address"},{title:"上次登录时间",key:"lastLoginTime"},{title:"上次登录IP",key:"lastLoginIp"}],{align:"center"});return m((function(){s({url:i,data:{page:1,pageSize:20}}).then(u.handleSuccess).catch(console.log)})),g=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&n(e,a,t[a]);if(r)for(var a of r(t))o.call(t,a)&&n(e,a,t[a]);return e})({tableRef:e,tableColumns:y},u),t(g,a({exportExcel:function(){const t=p.utils.table_to_sheet(e.value.$el),a=p.utils.book_new();p.utils.book_append_sheet(a,t,"数据报表"),p.writeFile(a,"tale-list.xlsx")}}));var g}});const w={class:"main-container"},O=v("导出Excel ");h.render=function(e,t,a,r,l,o){const n=y("n-button"),s=y("TableHeader"),i=y("n-data-table"),c=y("TableBody");return g(),x("div",w,[j(s,{"show-filter":!1},{"top-right":k((()=>[j(n,{type:"primary",size:"small",onClick:e.exportExcel},{default:k((()=>[O])),_:1},8,["onClick"])])),_:1}),j(c,{ref:"tableBody"},{default:k((()=>[j(i,{ref:"tableRef",data:e.dataList,columns:e.tableColumns},null,8,["data","columns"])])),_:1},512)])};export default h;
