var N=Object.defineProperty,O=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var b=(e,u,n)=>u in e?N(e,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[u]=n,A=(e,u)=>{for(var n in u||(u={}))S.call(u,n)&&b(e,n,u[n]);if(k)for(var n of k(u))V.call(u,n)&&b(e,n,u[n]);return e},B=(e,u)=>O(e,U(u));import{p as R,z as j,A as q,q as H,m as J,n as P,r as z}from"./index.d023bfa5.js";import{a as G,b as Q,c as W,e as X}from"./table.18292b07.js";import{d as Y,g as c,M as Z,a6 as ee,s as C,aE as E,k as ue,h as v,al as y,r as ne,o as ae,q as oe,a as s,w as m,bd as le,bC as te}from"./vendor.88197545.js";const M="ROLE_",w=[{label:"\u89D2\u8272\u540D\u79F0",type:"input",key:"name",value:c(null),validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"),!1),render:e=>v(y,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"})},{label:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",value:c(null),maxLength:20,validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u7F16\u7801"),!1),render:e=>v(y,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},{prefix:()=>v("div",M)})},{label:"\u89D2\u8272\u63CF\u8FF0",key:"description",value:c(null),maxLength:50,inputType:"text",validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"),!1),render:e=>v(y,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0",type:"textarea",rows:3})}];function L(e,u,n){const t=[];return e.forEach(r=>{const o={};o.key=r.menuUrl,o.label=r.menuName,u.push(o.key),r.children&&(n.push(o.key),o.children=L(r.children,u,n)),t.push(o)}),t}var se=Y({name:"Role",setup(){const e=c(null),u=c(null),n=c(null),t=G(),r=Q("id"),o=Z(),D=ee(),d=C([]),_=W([t.selectionColumn,t.indexColumn,{title:"\u89D2\u8272\u540D\u79F0",key:"name"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode"},{title:"\u89D2\u8272\u63CF\u8FF0",key:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode"},{title:"\u64CD\u4F5C",key:"actions",render:a=>X([{label:"\u7F16\u8F91",onClick:T.bind(null,a)},{label:"\u5220\u9664",type:"error",onClick:$.bind(null,a)},{label:"\u83DC\u5355\u6743\u9650",type:"success",onClick:I.bind(null,a)}])}],{align:"center"}),F=C([]),p=C([]);function f(){R({url:q,data:{}}).then(t.handleSuccess).catch(console.log)}function g(){var a;(a=e.value)==null||a.toggle(),E(()=>{var l;(l=u.value)==null||l.reset()})}function T(a){var l;(l=e.value)==null||l.toggle(),E(()=>{w.forEach(i=>{const K=i.key,h=a[K];h&&(i.key==="roleCode"?i.value.value=h.replace(M,""):i.value.value=h)})})}function $(a){o.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u8981\u5220\u9664\u6B64\u83DC\u5355\uFF1F",positiveText:"\u5220\u9664",onPositiveClick:()=>{D.success("\u6A21\u62DF\u83DC\u5355\u5220\u9664\u6210\u529F\uFF0C\u53C2\u6570\u4E3A"+JSON.stringify(a))}})}function x(){var a,l;((a=u.value)==null?void 0:a.validator())&&((l=e.value)==null||l.toggle(),o.success({title:"\u63D0\u793A",positiveText:"\u786E\u5B9A",content:"\u6A21\u62DF\u83DC\u5355\u6DFB\u52A0\u6210\u529F\uFF0C\u53C2\u6570\u4E3A\uFF1A"+JSON.stringify(u.value.generatorParams())}))}function I(a){R({url:j,data:{roleId:a.id}}).then(l=>{var i;d.length=0,d.push(...L(l.data,F,p)),(i=n.value)==null||i.toggle()}).catch(console.log)}return ue(f),B(A({modalDialogRef:e,menuModalDialogRef:n,dataFormRef:u,rowKey:r,menuData:d,tableColumns:_,formItems:w,defaultCheckedKeys:F,defaultExpandedKeys:p},t),{onAddItem:g,onDataFormConfirm:x})}});const re={class:"main-container"};function ie(e,u,n,t,r,o){const D=H,d=J,_=le,F=P,p=ne("DataForm"),f=z,g=te;return ae(),oe("div",re,[s(F,null,{header:m(()=>[s(d,{"show-filter":!1},{"top-right":m(()=>[s(D,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1})]),default:m(()=>[s(_,{loading:e.tableLoading,data:e.dataList,columns:e.tableColumns,"row-key":e.rowKey},null,8,["loading","data","columns","row-key"])]),_:1}),s(f,{ref:"modalDialogRef",onConfirm:e.onDataFormConfirm},{content:m(()=>[s(p,{ref:"dataFormRef",options:e.formItems},null,8,["options"])]),_:1},8,["onConfirm"]),s(f,{ref:"menuModalDialogRef",title:"\u83DC\u5355\u6743\u9650",contentHeight:"40vh"},{content:m(()=>[s(g,{data:e.menuData,checkable:"","block-line":"",cascade:"","default-expanded-keys":e.defaultExpandedKeys,"default-checked-keys":e.defaultCheckedKeys},null,8,["data","default-expanded-keys","default-checked-keys"])]),_:1},512)])}se.render=ie;export{se as default};
