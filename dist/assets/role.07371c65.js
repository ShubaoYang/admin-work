var U=Object.defineProperty,V=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var A=(e,u,a)=>u in e?U(e,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[u]=a,B=(e,u)=>{for(var a in u||(u={}))$.call(u,a)&&A(e,a,u[a]);if(_)for(var a of _(u))j.call(u,a)&&A(e,a,u[a]);return e},R=(e,u)=>V(e,S(u));import{p as E,o as H,q as J}from"./index.3c82985f.js";import{a as P,b as q,c as G,d as Z}from"./table.048db773.js";import{d as z,k as i,A as Q,y as W,V as k,Z as M,e as X,l as v,aE as b,r as c,o as Y,c as ee,a as r,w as D}from"./vendor.e0f74c14.js";const T="ROLE_",w=[{label:"\u89D2\u8272\u540D\u79F0",type:"input",key:"name",value:i(null),validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"),!1),render:e=>v(b,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"})},{label:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",value:i(null),maxLength:20,validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u7F16\u7801"),!1),render:e=>v(b,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},{prefix:()=>v("div",T)})},{label:"\u89D2\u8272\u63CF\u8FF0",key:"description",value:i(null),maxLength:50,inputType:"text",validator:(e,u)=>e.value.value?!0:(u.error("\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"),!1),render:e=>v(b,{value:e.value.value,onUpdateValue:u=>{e.value.value=u},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0",type:"textarea",rows:3})}];function L(e,u,a){const t=[];return e.forEach(s=>{const o={};o.key=s.menuUrl,o.label=s.menuName,u.push(o.key),s.children&&(a.push(o.key),o.children=L(s.children,u,a)),t.push(o)}),t}var ue=z({name:"Role",setup(){const e=i(null),u=i(null),a=i(null),t=P(),s=q("id"),o=Q(),y=W(),F=k([]),h=G([t.selectionColumn,t.indexColumn,{title:"\u89D2\u8272\u540D\u79F0",key:"name"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode"},{title:"\u89D2\u8272\u63CF\u8FF0",key:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode"},{title:"\u64CD\u4F5C",key:"actions",render:n=>Z([{label:"\u7F16\u8F91",onClick:x.bind(null,n)},{label:"\u5220\u9664",type:"error",onClick:I.bind(null,n)},{label:"\u83DC\u5355\u6743\u9650",type:"success",onClick:K.bind(null,n)}])}],{align:"center"}),m=k([]),p=k([]);function f(){E({url:J,data:{}}).then(t.handleSuccess).catch(console.log)}function C(){var n;(n=e.value)==null||n.toggle(),M(()=>{var l;(l=u.value)==null||l.reset()})}function x(n){var l;(l=e.value)==null||l.toggle(),M(()=>{w.forEach(d=>{const O=d.key,g=n[O];g&&(d.key==="roleCode"?d.value.value=g.replace(T,""):d.value.value=g)})})}function I(n){o.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u8981\u5220\u9664\u6B64\u83DC\u5355\uFF1F",positiveText:"\u5220\u9664",onPositiveClick:()=>{y.success("\u6A21\u62DF\u83DC\u5355\u5220\u9664\u6210\u529F\uFF0C\u53C2\u6570\u4E3A"+JSON.stringify(n))}})}function N(){var n,l;((n=u.value)==null?void 0:n.validator())&&((l=e.value)==null||l.toggle(),o.success({title:"\u63D0\u793A",positiveText:"\u786E\u5B9A",content:"\u6A21\u62DF\u83DC\u5355\u6DFB\u52A0\u6210\u529F\uFF0C\u53C2\u6570\u4E3A\uFF1A"+JSON.stringify(u.value.generatorParams())}))}function K(n){E({url:H,data:{roleId:n.id}}).then(l=>{var d;F.length=0,F.push(...L(l.data,m,p)),(d=a.value)==null||d.toggle()}).catch(console.log)}return X(f),R(B({modalDialogRef:e,menuModalDialogRef:a,dataFormRef:u,rowKey:s,menuData:F,tableColumns:h,formItems:w,defaultCheckedKeys:m,defaultExpandedKeys:p},t),{onAddItem:C,onDataFormConfirm:N})}});const ae={class:"main-container"};function ne(e,u,a,t,s,o){const y=c("AddButton"),F=c("TableHeader"),h=c("n-data-table"),m=c("TableBody"),p=c("DataForm"),f=c("ModalDialog"),C=c("n-tree");return Y(),ee("div",ae,[r(F,{"show-filter":!1},{"top-right":D(()=>[r(y,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1}),r(m,null,{default:D(()=>[r(h,{loading:e.tableLoading,data:e.dataList,columns:e.tableColumns,"row-key":e.rowKey},null,8,["loading","data","columns","row-key"])]),_:1}),r(f,{ref:"modalDialogRef",onConfirm:e.onDataFormConfirm},{content:D(()=>[r(p,{ref:"dataFormRef",options:e.formItems},null,8,["options"])]),_:1},8,["onConfirm"]),r(f,{ref:"menuModalDialogRef",title:"\u83DC\u5355\u6743\u9650",contentHeight:"40vh"},{content:D(()=>[r(C,{data:e.menuData,checkable:"","block-line":"",cascade:"","default-expanded-keys":e.defaultExpandedKeys,"default-checked-keys":e.defaultCheckedKeys},null,8,["data","default-expanded-keys","default-checked-keys"])]),_:1},512)])}ue.render=ne;export{ue as default};
