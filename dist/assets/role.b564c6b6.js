var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{p as u,n as d,o as i}from"./index.6420dcfd.js";import{u as s,b as c,a as v,d as f}from"./table.9eaf7aec.js";import{d as p,k as m,B as y,A as b,W as g,_ as k,e as h,l as C,aE as x,r as O,o as w,c as D,a as j,w as R}from"./vendor.25688f0d.js";const E=[{label:"角色名称",type:"input",key:"name",value:m(null),validator:(e,a)=>!!e.value.value||(a.error("请输入角色名称"),!1),render:e=>C(x,{value:e.value.value,onUpdateValue:a=>{e.value.value=a},placeholder:"请输入角色名称"})},{label:"角色编号",key:"roleCode",value:m(null),maxLength:20,validator:(e,a)=>!!e.value.value||(a.error("请输入角色编码"),!1),render:e=>C(x,{value:e.value.value,onUpdateValue:a=>{e.value.value=a},placeholder:"请输入角色描述"},{prefix:()=>C("div","ROLE_")})},{label:"角色描述",key:"description",value:m(null),maxLength:50,inputType:"text",validator:(e,a)=>!!e.value.value||(a.error("请输入角色名称"),!1),render:e=>C(x,{value:e.value.value,onUpdateValue:a=>{e.value.value=a},placeholder:"请输入角色描述",type:"textarea",rows:3})}];function P(e,a,l){const t=[];return e.forEach((e=>{const n={};n.key=e.menuUrl,n.label=e.menuName,a.push(n.key),e.children&&(l.push(n.key),n.children=P(e.children,a,l)),t.push(n)})),t}var _=p({name:"Role",setup(){const e=m(null),p=m(null),C=m(null),x=s(),O=c("id"),w=y(),D=b(),j=g([]),R=v([x.selectionColumn,x.indexColumn,{title:"角色名称",key:"name"},{title:"角色编号",key:"roleCode"},{title:"角色描述",key:"description"},{title:"创建时间",key:"createTime"},{title:"角色编号",key:"roleCode"},{title:"操作",key:"actions",render:e=>f([{label:"编辑",onClick:I.bind(null,e)},{label:"删除",type:"error",onClick:K.bind(null,e)},{label:"菜单权限",type:"success",onClick:L.bind(null,e)}])}],{align:"center"}),_=g([]),A=g([]);function I(a){var l;null==(l=e.value)||l.toggle(),k((()=>{E.forEach((e=>{const l=e.key,t=a[l];t&&("roleCode"===e.key?e.value.value=t.replace("ROLE_",""):e.value.value=t)}))}))}function K(e){w.warning({title:"提示",content:"是否要删除此菜单？",positiveText:"删除",onPositiveClick:()=>{D.success("模拟菜单删除成功，参数为"+JSON.stringify(e))}})}function L(e){u({url:d,data:{roleId:e.id}}).then((e=>{var a;j.length=0,j.push(...P(e.data,_,A)),null==(a=C.value)||a.toggle()})).catch(console.log)}return h((function(){u({url:i,data:{}}).then(x.handleSuccess).catch(console.log)})),T=((e,a)=>{for(var l in a||(a={}))n.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({modalDialogRef:e,menuModalDialogRef:C,dataFormRef:p,rowKey:O,menuData:j,tableColumns:R,formItems:E,defaultCheckedKeys:_,defaultExpandedKeys:A},x),a(T,l({onAddItem:function(){var a;null==(a=e.value)||a.toggle(),k((()=>{var e;null==(e=p.value)||e.reset()}))},onDataFormConfirm:function(){var a,l;(null==(a=p.value)?void 0:a.validator())&&(null==(l=e.value)||l.toggle(),w.success({title:"提示",positiveText:"确定",content:"模拟菜单添加成功，参数为："+JSON.stringify(p.value.generatorParams())}))}}));var T}});const A={class:"main-container"};_.render=function(e,a,l,t,n,o){const r=O("AddButton"),u=O("TableHeader"),d=O("n-data-table"),i=O("TableBody"),s=O("DataForm"),c=O("ModalDialog"),v=O("n-tree");return w(),D("div",A,[j(u,{"show-filter":!1},{"top-right":R((()=>[j(r,{onAdd:e.onAddItem},null,8,["onAdd"])])),_:1}),j(i,null,{default:R((()=>[j(d,{loading:e.tableLoading,data:e.dataList,columns:e.tableColumns,"row-key":e.rowKey},null,8,["loading","data","columns","row-key"])])),_:1}),j(c,{ref:"modalDialogRef",onConfirm:e.onDataFormConfirm},{content:R((()=>[j(s,{ref:"dataFormRef",options:e.formItems},null,8,["options"])])),_:1},8,["onConfirm"]),j(c,{ref:"menuModalDialogRef",title:"菜单权限",contentHeight:"40vh"},{content:R((()=>[j(v,{data:e.menuData,checkable:"","block-line":"",cascade:"","default-expanded-keys":e.defaultExpandedKeys,"default-checked-keys":e.defaultCheckedKeys},null,8,["data","default-expanded-keys","default-checked-keys"])])),_:1},512)])};export default _;
