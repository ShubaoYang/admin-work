var M=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var B=(u,a,n)=>a in u?M(u,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[a]=n,S=(u,a)=>{for(var n in a||(a={}))$.call(a,n)&&B(u,n,a[n]);if(E)for(var n of E(a))j.call(a,n)&&B(u,n,a[n]);return u},N=(u,a)=>P(u,R(a));import{u as x,i as L,t as O,j as J,p as K,k as q,m as H}from"./index.84f8988a.js";import{a as V,b as G,c as z,d as Q}from"./table.3aa45a9e.js";import{g as W,r as g,h as X,i as h}from"./form.2692a804.js";import{d as Y,B as Z,A as ee,k as t,l as o,N as ue,m as ae,aE as ne,e as le,t as te,v as oe,r as s,o as re,c as de,a as i,i as se}from"./vendor.2777dd0c.js";var I=Y({name:"Menu",setup(){let u="add",a=null;const n=V(),C=Z(),v=ee(),_=x(),c=t(null),r=t(null),p=G("menuUrl"),b=z([{title:"\u83DC\u5355\u540D\u79F0",key:"menuName"},{title:"\u83DC\u5355\u5730\u5740",key:"menuUrl"},{title:"\u83DC\u5355\u56FE\u6807",key:"icon",render:e=>e.iconPrefix==="iconfont"?o(L,{prefix:e.iconPrefix?e.iconPrefix:"iconfont",name:e.icon?e.icon:"menu"}):o(ue,null,{default:()=>o("svg",{"aria-hidden":!1},{default:()=>[o("use",{href:"#icon-menu"})]})})},{title:"\u63D0\u793A\u4FE1\u606F",key:"badge",render:e=>e.badge?o(ae,{value:e.badge,dot:e.badge==="dot"}):o("span",null,{default:()=>"--"})},{title:"\u662F\u5426\u7F13\u5B58",key:"cacheable",render:e=>o("div",null,{default:()=>e.cacheable?"\u662F":"\u5426"})},{title:"\u662F\u5426\u9690\u85CF",key:"hidden",render:e=>o("div",null,{default:()=>e.hidden?"\u662F":"\u5426"})},{title:"\u662F\u5426\u56FA\u5B9A\u6807\u9898\u680F",key:"affix",render:e=>o("div",null,{default:()=>e.affix?"\u662F":"\u5426"})},{title:"\u64CD\u4F5C",key:"actions",render:e=>Q([{label:"\u7F16\u8F91",onClick:T.bind(null,e)},{label:"\u5220\u9664",type:"error",onClick:A.bind(null,e)}])}],{align:"center"}),m=[{label:"\u4E0A\u7EA7\u83DC\u5355",key:"parentPath",value:t(null),validator:(e,l)=>e.value.value?!0:(l.error("\u8BF7\u9009\u62E9\u4E0A\u7EA7\u83DC\u5355"),!1),render:e=>W(e.value,O(n.dataList,"menuName","menuUrl"))},{label:"\u83DC\u5355\u540D\u79F0",key:"menuName",required:!0,value:t(null),render:e=>g(e.value,{placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"})},{label:"\u83DC\u5355\u5730\u5740",key:"menuUrl",required:!0,value:t(null),disabled:t(!1),render:e=>g(e.value,{placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u5730\u5740",disabled:e.disabled.value}),reset:e=>{e.value.value=null,e.disabled.value=!1}},{label:"\u5916\u94FE\u5730\u5740",key:"redirect",value:t(null),render:e=>g(e.value,{placeholder:"\u8BF7\u8F93\u5165\u5916\u94FE\u5730\u5740"})},{label:"\u83DC\u5355\u56FE\u6807",key:"icon",value:t(null),render:e=>o(J,{defaultIcon:e.value.value,onUpdateIcon:l=>{e.value.value=l.name}})},{label:"\u63D0\u793A\u4FE1\u606F",key:"badge",value:t(null),render:e=>o("div",null,{default:()=>[X(e.value,[{label:"\u7EA2\u70B9",value:"dot"},{label:"new",value:"new"}]),o(ne,{placeholder:"\u5982\u679C\u6B64\u9879\u4E3A\u7A7A\uFF0C\u5219\u8BF4\u660E\u4E0D\u9700\u8981\u63D0\u793A\u4FE1\u606F",class:"mt-4",value:e.value.value,onUpdateValue:l=>{e.value.value=l}})]})},{label:"\u662F\u5426\u7F13\u5B58",key:"cacheable",value:t(!1),render:e=>h(e.value)},{label:"\u662F\u5426\u9690\u85CF",key:"hidden",value:t(!1),render:e=>h(e.value)},{label:"\u662F\u5426\u56FA\u5B9A",key:"affix",value:t(!0),render:e=>h(e.value)}];function y(){K({url:q,data:{}}).then(n.handleSuccess).catch(console.log)}function U(){var e;u="add",(e=c.value)==null||e.show().then(()=>{var l;(l=r.value)==null||l.reset()})}function T(e){var l;u="edit",a=e,m.forEach(d=>{d.value.value=e[d.key]||null,d.key==="menuUrl"&&d.disabled&&(d.disabled.value=!0)}),(l=c.value)==null||l.show()}function w(){var e,l,d,k;if(u==="add")((e=r.value)==null?void 0:e.validator())&&v.success("\u6A21\u62DF\u521B\u5EFA\u83DC\u5355\u6210\u529F, \u53C2\u6570\u4E3A:"+JSON.stringify((l=r.value)==null?void 0:l.generatorParams()));else if((d=r.value)==null?void 0:d.validator()){const D=(k=r.value)==null?void 0:k.generatorParams();if(a){const f=H(_.state.permissionRoutes,a.menuUrl);f&&f.meta&&f.meta.badge&&(f.meta.badge=D.badge||"")}v.success("\u6A21\u62DF\u4FEE\u6539\u83DC\u5355\u6210\u529F, \u53C2\u6570\u4E3A:"+JSON.stringify(D))}}function A(e){C.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u8981\u5220\u9664\u6B64\u6570\u636E\uFF1F",positiveText:"\u5220\u9664",onPositiveClick:()=>{v.success("\u6A21\u62DF\u5220\u9664\u6210\u529F\uFF0C\u53C2\u6570\u4E3A\uFF1A"+JSON.stringify(e))}})}return le(y),N(S({rowKey:p,modalDialog:c,dataForm:r},n),{itemFormOptions:m,tableColumns:b,onAddItem:U,onDeleteItem:A,onConfirm:w})}});const F=se();te("data-v-06019dfe");const ie={class:"main-container"};oe();const ce=F((u,a,n,C,v,_)=>{const c=s("AddButton"),r=s("TableHeader"),p=s("n-data-table"),b=s("TableBody"),m=s("DataForm"),y=s("ModalDialog");return re(),de("div",ie,[i(r,{"show-filter":!1},{"top-right":F(()=>[i(c,{onAdd:u.onAddItem},null,8,["onAdd"])]),_:1}),i(b,null,{default:F(()=>[i(p,{loading:u.tableLoading,data:u.dataList,"row-key":u.rowKey,columns:u.tableColumns},null,8,["loading","data","row-key","columns"])]),_:1}),i(y,{ref:"modalDialog",onConfirm:u.onConfirm,"content-height":"50vh"},{content:F(()=>[i(m,{ref:"dataForm",options:u.itemFormOptions},null,8,["options"])]),_:1},8,["onConfirm"])])});I.render=ce;I.__scopeId="data-v-06019dfe";export{I as default};
